<!DOCTYPE html>
<html>

<head>
	<title></title>
	<meta charset="utf-8">
	<link rel="stylesheet" href="../lib/layui/css/layui.css" />
	<link rel="stylesheet" href="../assets/style/base.css" />
	<link rel="stylesheet" href="../assets/style/menu.css" />
</head>

<body>
	<div class="page-menu">
		<div class="layui-fluid layui-bg-gray" lay-separator=">">
			<span class="layui-breadcrumb">
				<a href="./pages/home.html" target="showConent">首页</a>
				<a href="">计划菜单</a>
				<a>
					<cite>正文</cite>
				</a>
			</span>
		</div>
		<div class="layui-row menu-title" style="margin-top:20px">
			<div class="layui-col-md4 layui-col-md-offset4">
				<h2>中广核大厦北楼
					<span class="layui-blue">自助餐</span>计划菜单</h2>
			</div>
			<div class="layui-col-md4" style="text-align:right;padding-right:20px;">
				<a target="showConent" href="../pages/planFeeding.html" class="layui-btn layui-btn-normal">计划投料</a>
			</div>
		</div>
		<hr class="layui-bg-gray">
		<div class="layui-form-item" style="margin-top:20px;">
			<div class="layui-inline" style="margin-left:-20px">
				<label class="layui-form-label">计划时间</label>
				<div class="layui-input-inline" style="width:200px;">
					<input type="text" name="price_min" autocomplete="off" class="layui-input" id="planStart" />
				</div>
				<div class="layui-form-mid">-</div>
				<div class="layui-input-inline" style="width:200px;">
					<input type="text" name="price_min" autocomplete="off" class="layui-input" id="planEnd" />
				</div>
			</div>
			<div class="layui-inline">
				<label>查看当前菜谱</label>
			</div>
		</div>
		<div class="layui-form-item">
			<div class="layui-inline" style="margin-left:-20px">
				<label class="layui-form-label">菜单状态</label>
			</div>
			<div class="layui-inline">
				<label class="color-red">待制作</label>
			</div>
		</div>
		<div class="layui-tab layui-form-item" style="margin:0 20px">
			<div class="layui-block">
				<div class="layui-inline" style="margin-top:5px;margin-bottom:-5px;margin-right:10px">
					菜单分类
				</div>
				<ul class="layui-tab-title layui-inline" style="margin-bottom:-10px">
					<li class="layui-this">早餐</li>
					<li id="alertLayout">午餐</li>
					<li>晚餐</li>
				</ul>
			</div>
			<hr class="layui-bg-green">
			<div class="layui-tabbar-content">
				<div class="layui-tab-item layui-show">
					<table class="layui-table" id="menuTable" style="margin-top:20px;">
						<colgroup>
							<col>
							<col>
							<col>
							<col>
							<col>
							<col>
							<col>
							<col>
						</colgroup>
						<thead>
							<tr>
								<th width="60px"></th>
								<th>星期一</th>
								<th>星期二</th>
								<th>星期三</th>
								<th>星期四</th>
								<th>星期五</th>
								<th>星期六</th>
								<th>星期日</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>
									就餐人数
								</td>
								<td class="eat-number">
									<input type="" name="" class="layui-input" />
								</td>
								<td class="eat-number">
									<input type="" name="" class="layui-input" />
								</td>
								<td class="eat-number">
									<input type="" name="" class="layui-input" />
								</td>
								<td class="eat-number">
									<input type="" name="" class="layui-input" />
								</td>
								<td class="eat-number">
									<input type="" name="" class="layui-input" />
								</td>
								<td class="eat-number">
									<input type="" name="" class="layui-input" />
								</td>
								<td class="eat-number">
									<input type="" name="" class="layui-input" />
								</td>
							</tr>
							<tr bgcolor="#f2f2f2">
								<td colspan="8">菜谱列表</td>
							</tr>
							<tr>
								<td>豆制品</td>
								<td>
									<div class="item">豆浆
										<i class="layui-icon fr delete-item">&#x1007;</i>
									</div>
									<div class="item">豆浆
										<i class="layui-icon fr delete-item">&#x1007;</i>
									</div>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr>
								<td>奶制品</td>
								<td>
									<div class="item">牛奶
										<i class="layui-icon fr delete-item">&#x1007;</i>
									</div>
									<div class="item">酸奶
										<i class="layui-icon fr delete-item">&#x1007;</i>
									</div>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr>
								<td>油炸类</td>
								<td>
									<div class="item">油条
										<i class="layui-icon fr delete-item">&#x1007;</i>
									</div>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr>
								<td>粥类</td>
								<td>
									<div class="item">白稀饭
										<i class="layui-icon fr delete-item">&#x1007;</i>
									</div>
									<div class="item">小米粥
										<i class="layui-icon fr delete-item">&#x1007;</i>
									</div>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr>
								<td>面粉类</td>
								<td>
									<div class="item">汤河粉
										<i class="layui-icon fr delete-item">&#x1007;</i>
									</div>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr>
								<td>中西糕点类</td>
								<td>
									<div class="item">
										面包
										<i class="layui-icon fr delete-item">&#x1007;</i>
									</div>
									<div class="item">
										三明治
										<i class="layui-icon fr delete-item">&#x1007;</i>
									</div>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr>
								<td>小菜类</td>
								<td>
									<div class="item">
										肉末腌菜
										<i class="layui-icon fr delete-item">&#x1007;</i>
									</div>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
						</tbody>
					</table>
				</div>
				<div class="layui-tab-item">内容2</div>
				<div class="layui-tab-item">内容3</div>
			</div>
		</div>
		<div class="layui-form-item" style="padding-top:10px;">
			<div class="layui-input-block">
				<button class="layui-btn" lay-submit lay-filter="formDemo">存草稿</button>
				<button type="reset" class="layui-btn layui-btn-primary">提交审核</button>
			</div>
		</div>
	</div>

	<div class="layout-content layui-tab-content" style="display:none;">
		<div class="layui-form">
			<div class="layui-form-item">
				<label class="layui-form-label">荤素</label>
				<div class="layui-input-block">
					<input type="radio" name="like[1]" title="大荤">
					<input type="radio" name="like[1]" title="小荤" checked>
					<input type="radio" name="like[1]" title="清淡">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">类别</label>
				<div class="layui-input-block">
					<input type="radio" name="like[2]" title="牛肉">
					<input type="radio" name="like[2]" title="羊肉" checked>
					<input type="radio" name="like[2]" title="鸡肉">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">季节菜</label>
				<div class="layui-input-block">
					<input type="radio" name="like[3]" title="当季菜">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">菜品名称</label>
				<div class="layui-input-block" style="width:300px;">
					<input type="text" name="title" required lay-verify="required" placeholder="请输入菜品名称" autocomplete="off" class="layui-input">
				</div>
			</div>
			<div class="layui-table-wrapper">
				<table class="layui-table" id="alertMenuTable">
					<colgroup>
						<col>
						<col>
						<col>
						<col>
					</colgroup>
					<thead>
						<tr>
							<th>类别</th>
							<th>二级类别</th>
							<th>菜名</th>
							<th>操作</th>
						</tr>
					</thead>
					<tbody class="layui-table-body ">
						<tr>
							<td>素菜</td>
							<td>蔬菜</td>
							<td>清炒大白菜</td>
							<td class="select ">选择</td>
						</tr>
						<tr>
							<td>面食</td>
							<td>面点</td>
							<td>肉包</td>
							<td class="select ">选择</td>
						</tr>
						<tr>
							<td>大荤</td>
							<td>牛肉</td>
							<td>土豆烧牛肉</td>
							<td class="select ">选择</td>
						</tr>
					</tbody>
				</table>
			</div>

		</div>
	</div>

	<script src="../lib/layui/layui.js "></script>
	<script src="../lib/jquery/jquery.min.js "></script>
	<script>
		//JavaScript代码区域
		layui.use('element', function () {
			var element = layui.element;
			//获取hash来切换选项卡，假设当前地址的hash为lay-id对应的值
			var layid = location.hash.replace(/^#test1=/, '');
			element.tabChange('test1', layid); //假设当前地址为：http://a.com#test1=222，那么选项卡会自动切换到“发送消息”这一项

			//监听Tab切换，以改变地址hash值
			element.on('tab(test1)', function () {
				location.hash = 'test1=' + this.getAttribute('lay-id');
			});
		});

		layui.use('laydate', function () {
			var laydate = layui.laydate;

			//执行一个laydate实例
			laydate.render({
				elem: '#planStart' //指定元素
			});
		});

		layui.use('laydate', function () {
			var laydate = layui.laydate;

			//执行一个laydate实例
			laydate.render({
				elem: '#planEnd' //指定元素
			});
		});

		layui.use('layer', function () {
			var layer = layui.layer;
		});

		layui.use('form', function () {
			var form = layui.form;

			//监听提交
			form.on('submit(formDemo)', function (data) {
				layer.msg(JSON.stringify(data.field));
				return false;
			});
		});

		$(function () {
			var whichTd; //保存被点击的单元格
			//删除功能提示
			$('#menuTable').on('click','.delete-item',function (event) {
				event.stopPropagation;
				var target = this
				layer.confirm('您确定要删除吗？', { icon: 3, title: '提示' }, function (index) {
					$(target).parent().remove();
					layer.close(index);
				});
			});

			//表格中添加菜名
			$("#menuTable").on('click','td',function () {
				if($(this)[0].innerText.length==0){
					whichTd = $(this);
					let oTop = 0,oLeft = 0;
					let tdTop = $(this).context.offsetTop;
					let tdLeft = $(this).context.offsetLeft;
					let tdWidth = $(this).context.offsetWidth;
					let tdHeight = $(this).context.offsetHeight;
					let winWidth = $(window).width();
					let winHeight = $(window).height();
					let winScrollTop = $(window).scrollTop();
					let cntHeight = $('.layout-content').outerHeight(true);
					let isTop,isLeft

					if(tdLeft > winWidth/2){
						oLeft = tdLeft - 500;
						isLeft = false;
						console.log('在右侧');
					}else{
						oLeft = tdLeft + tdWidth;
						isLeft = true;
						console.log('在左侧');
					}

					if(tdTop - winScrollTop > winHeight/2){
						console.log('在下侧');
						isTop = false;
						oTop = tdTop - winScrollTop - cntHeight;
						console.log(tdTop,winScrollTop)
						if(isLeft){
							oTop -= tdHeight;
							console.log('hhff');
						}
					}else{
						console.log('在上侧');
						isTop = true;
						oTop = tdTop - winScrollTop;
					}

					if(oLeft + 500 > winWidth){
						oLeft = winWidth - 500
					}

					if((oTop - winScrollTop + cntHeight) > winHeight){
						oTop = winHeight - cntHeight
					}

					if(oTop<0){
						oTop = 0
					}

					layer.open({
						type: 1,
						title: '菜谱库',
						area: '500px',
						offset: [oTop+'px',oLeft+'px'],
						content: $('.layout-content') //这里content是一个普通的String
					});
				}
			});


			//选择功能
			$("#alertMenuTable .select").on('click',function () {
				var foodName = $(this).prev().text();
				var _html = '<div class="item">'+foodName+'<i class="layui-icon fr delete-item">&#x1007;</i></div>';
				whichTd.append(_html);
			});
		});
	</script>
</body>

</html>